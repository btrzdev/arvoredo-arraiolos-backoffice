(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[658],{5278:function(e,t,r){Promise.resolve().then(r.bind(r,1847))},1847:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return f}});var n=r(7437),o=r(2265),s=r(6463),a=r(7135),i=r(3102),l=r(495),u=r(8726),c=r(1633),d=r(7138);function f(){let[e,t]=(0,o.useState)(""),[r,f]=(0,o.useState)(""),[g,h]=(0,o.useState)(""),[p,m]=(0,o.useState)(!1),v=(0,s.useRouter)(),{setAuthenticated:b}=(0,c.O2)(),x=async t=>{t.preventDefault(),h(""),m(!0);try{let t=await fetch("/api/auth/signin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:r})});if(t.ok){b(!0);let e=await t.json();localStorage.setItem("token",e.token),u.Am.success("Login"),v.push("/")}else{let e=await t.json();h(e.message||"Authentication failed"),u.Am.error(e.message||"Authentication failed")}}catch(e){b(!1),console.error("Error during sign-in:",e),h("Something went wrong"),u.Am.error("Something went wrong")}finally{m(!1)}};return(0,n.jsxs)("div",{className:"mx-auto mt-16 max-w-md",children:[(0,n.jsx)("h1",{className:"mb-4 text-2xl font-bold",children:"Login"}),(0,n.jsxs)("form",{onSubmit:x,children:[(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)(a._,{htmlFor:"email",children:"Email"}),(0,n.jsx)(i.I,{id:"email",type:"email",value:e,onChange:e=>t(e.target.value),required:!0})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)(a._,{htmlFor:"password",children:"Password"}),(0,n.jsx)(i.I,{id:"password",type:"password",value:r,onChange:e=>f(e.target.value),required:!0})]}),(0,n.jsxs)("div",{className:"mb-[20px] flex gap-[2px] text-[12px]",children:[(0,n.jsx)("span",{children:"Ainda n\xe3o possui uma conta?"}),(0,n.jsx)(d.default,{href:"/sign-up",className:"text-blue-400 hover:brightness-75",children:"Registrar"})]}),g&&(0,n.jsx)("p",{className:"text-red-500",children:g}),(0,n.jsx)(l.z,{type:"submit",disabled:p,children:p?"Loading...":"Entrar"})]})]})}},1633:function(e,t,r){"use strict";r.d(t,{Ho:function(){return c},O2:function(){return d}});var n=r(7437),o=r(6463),s=r(2265),a=r(9714);let i=e=>{try{let t=(0,a.o)(e),r=Math.floor(Date.now()/1e3);return t.exp>r}catch(e){return!1}},l=e=>{try{let t=(0,a.o)(e),r=Math.floor(Date.now()/1e3);if(t.exp>r)return{token:t,refreshToken:e}}catch(e){console.error("Failed to decode refresh token:",e)}return null},u=(0,s.createContext)(void 0),c=e=>{let{children:t}=e,[r,c]=(0,s.useState)(!0),[d,f]=(0,s.useState)(!1),[g,h]=(0,s.useState)(null),[p,m]=(0,s.useState)(),[v,b]=(0,s.useState)({userGroup:""}),[x,w]=(0,s.useState)({latitude:0,longitude:0}),[y,k]=(0,s.useState)(!1),[j,S]=(0,s.useState)(),[N,I]=(0,s.useState)(),E=(0,o.useRouter)();return(0,s.useEffect)(()=>{let e=localStorage.getItem("token"),t=localStorage.getItem("refreshToken");(async()=>{if(e&&i(e))h(e),b((0,a.o)(e)),f(!0);else if(t){let e=l(t);e?(localStorage.setItem("token",e.token),localStorage.setItem("refreshToken",e.refreshToken),f(!0)):E.push("/sign-in")}else E.push("/sign-in");c(!1)})()},[]),(0,n.jsx)(u.Provider,{value:{authenticated:d,setAuthenticated:f,loading:r,setLoading:c,token:g,setToken:h,editors:p,setEditors:m,userType:v,setUserType:b,latLong:x,setLatLong:w,showDeleteModal:y,setShowDeleteModal:k,treeToDeleteId:j,setTreeToDeleteId:S,dataUpdated:N,setDataUpdated:I},children:t})},d=()=>{let e=(0,s.useContext)(u);if(!e)throw Error("useEvent must be used within an EventProvider");return e}},495:function(e,t,r){"use strict";r.d(t,{z:function(){return u}});var n=r(7437),o=r(2265),s=r(1538),a=r(2218),i=r(7440);let l=(0,a.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),u=o.forwardRef((e,t)=>{let{className:r,variant:o,size:a,asChild:u=!1,...c}=e,d=u?s.g7:"button";return(0,n.jsx)(d,{className:(0,i.cn)(l({variant:o,size:a,className:r})),ref:t,...c})});u.displayName="Button"},3102:function(e,t,r){"use strict";r.d(t,{I:function(){return a}});var n=r(7437),o=r(2265),s=r(7440);let a=o.forwardRef((e,t)=>{let{className:r,type:o,...a}=e;return(0,n.jsx)("input",{type:o,className:(0,s.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...a})});a.displayName="Input"},7135:function(e,t,r){"use strict";r.d(t,{_:function(){return u}});var n=r(7437),o=r(2265),s=r(8364),a=r(2218),i=r(7440);let l=(0,a.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),u=o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,n.jsx)(s.f,{ref:t,className:(0,i.cn)(l(),r),...o})});u.displayName=s.f.displayName},7440:function(e,t,r){"use strict";r.d(t,{cn:function(){return s}});var n=r(4839),o=r(6164);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,o.m6)((0,n.W)(t))}},8364:function(e,t,r){"use strict";r.d(t,{f:function(){return i}});var n=r(2265),o=r(5171),s=r(7437),a=n.forwardRef((e,t)=>(0,s.jsx)(o.WV.label,{...e,ref:t,onMouseDown:t=>{var r;t.target.closest("button, input, select, textarea")||(null===(r=e.onMouseDown)||void 0===r||r.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));a.displayName="Label";var i=a},9714:function(e,t,r){"use strict";r.d(t,{o:function(){return o}});class n extends Error{}function o(e,t){let r;if("string"!=typeof e)throw new n("Invalid token specified: must be a string");t||(t={});let o=!0===t.header?0:1,s=e.split(".")[o];if("string"!=typeof s)throw new n(`Invalid token specified: missing part #${o+1}`);try{r=function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw Error("base64 string is not of the correct length")}try{var r;return r=t,decodeURIComponent(atob(r).replace(/(.)/g,(e,t)=>{let r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r}))}catch(e){return atob(t)}}(s)}catch(e){throw new n(`Invalid token specified: invalid base64 for part #${o+1} (${e.message})`)}try{return JSON.parse(r)}catch(e){throw new n(`Invalid token specified: invalid json for part #${o+1} (${e.message})`)}}n.prototype.name="InvalidTokenError"}},function(e){e.O(0,[991,726,138,971,23,744],function(){return e(e.s=5278)}),_N_E=e.O()}]);